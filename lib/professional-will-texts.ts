/**
 * טקסטים משפטיים מקצועיים מדויקים לצוואות
 * על בסיס התבניות המקצועיות של עורכי דין
 */

export interface ProfessionalWillSection {
  id: string;
  category: 'individual' | 'mutual' | 'both';
  title: string;
  content: string;
  variables: string[];
  required: boolean;
  order: number;
}

// טקסטים מדויקים לצוואת יחיד
export const individualWillSections: ProfessionalWillSection[] = [
  {
    id: 'individual-opening',
    category: 'individual',
    title: 'פתיחת צוואת יחיד',
    content: `הואיל כי אין אדם יודע את יום פקודתו;

והואיל כי ברצוני לערוך את צוואתי, ולפרט את רצוני האחרון והוראותיי בכל הקשור לאשר ייעשה ברכושי לאחר פטירתי, לאחר אריכות ימים ושנים;

והואיל כי הנני למעלה מגיל שמונה עשרה שנים, {{gender:אזרח|אזרחית}} ישראל{{gender:|ית}} ו{{gender:תושב|תושבת}} מדינת ישראל;

לפיכך אני הח"מ {{testator_full_name}} ת"ז {{testator_id}} מרחוב: {{testator_address}}. לאחר שיקול דעת, ובהיותי בדעה צלולה ובכושר גמור להבחין בטיבה של צוואה, הנני מצווה בזאת בדעה מוגמרת וללא כל השפעה בלתי הוגנת עלי מצד כלשהו, את מה שייעשה ברכושי לאחר מותי, קובע ומצהיר כמפורט להלן:`,
    variables: ['testator_full_name', 'testator_id', 'testator_address'],
    required: true,
    order: 1
  },

  {
    id: 'individual-property-details',
    category: 'individual', 
    title: 'פירוט נכסי מקרקעין - צוואת יחיד',
    content: `זכויות בדירה הרשומה בטאבו {{property_address}}, בעיר {{property_city}}, הידועה כגוש: {{property_block}}, חלקה: {{property_plot}}, תת חלקה: {{property_sub_plot}} (להלן: "{{property_name}}") וכן את מטלטליה בין המחוברים חיבור של קבע ובין שאינם מחוברים חיבור של קבע.`,
    variables: ['property_address', 'property_city', 'property_block', 'property_plot', 'property_sub_plot', 'property_name'],
    required: false,
    order: 4
  },

  {
    id: 'individual-bank-account',
    category: 'individual',
    title: 'פירוט חשבון בנק - צוואת יחיד', 
    content: `חשבון הבנק המנוהל על שמי בבנק {{bank_name}}, סניף מספר {{branch_number}}, חשבון מספר {{account_number}}, לרבות יתרת הכספים בחשבון, פיקדונות חיסכון וכלל הזכויות הכספיות הנובעות מחשבון זה.`,
    variables: ['bank_name', 'branch_number', 'account_number'],
    required: false,
    order: 5
  },

  {
    id: 'individual-cash-assets',
    category: 'individual',
    title: 'כספים במזומן - צוואת יחיד',
    content: `את כלל הכספים במזומן הנמצאים ברשותי, לרבות שטרות כסף המוחזקים בביתי, בכספת או בכל מקום אחר.`,
    variables: [],
    required: false,
    order: 6
  }
];

// טקסטים מדויקים לצוואה הדדית
export const mutualWillSections: ProfessionalWillSection[] = [
  {
    id: 'mutual-opening',
    category: 'mutual',
    title: 'פתיחת צוואה הדדית',
    content: `בהיות אין אדם יודע יום פקודתו.

אנו החתומים מטה, נשואים זה לזו כדת וכדין, מצהירים כי צוואה הדדית זו נערכת מתוך הסתמכות של כל אחד מאיתנו על הוראות הצוואה של האחר. בהיותנו סומכים ומסתמכים באופן הדדי זה על זו, ברצוננו לערוך צוואה הדדית בהתאם לסעיף 8א לחוק הירושה, תשכ"ה-1965, ועל כל המשתמע מכך בצוואה אחת והדדית בתוכנה, ביחס לרכושנו וכל אשר לנו, ולהביע בזה את רצוننו האחרון, ולפרט בה את הוראותינו על מה שיעשה ברכושנו אחרי פטירתנו, ורצוננו הוא שייתן לצוואה זו תוקף חוקי.`,
    variables: [],
    required: true,
    order: 1
  },

  {
    id: 'mutual-basic-clauses', 
    category: 'mutual',
    title: 'סעיפים בסיסיים - צוואה הדדית',
    content: `1. אנו נשואים משנת {{marriage_year}} חיים יחד באושר ומקיימים האחד את השנייה.

2. למען הסר ספק, אנו מבטלים בזה ביטול גמור, כל צוואה ו/או הוראה שנתנו בעבר לפני תאריך חתימה על צוואה זו, בין בכתב ובין בעל פה בקשור לרכושנו ולנכסנו, כל מסמך, או כתב, כל שיחה שבעל פה, שיש בה מעין גילוי דעת על מה שיש ברצוננו שייעשה בעיזבוננו לאחר מותנו.

3. אנו מורים ליורשים אשר יבצעו את צוואתנו לשלם מתוך עיזבוננו האמור את כל חובותינו שיעמדו לפירעון בעת פטירתנו, הוצאות הבאתנו לארץ אם פטירתנו תהא בחו"ל והוצאות קבורתנו, כולל הקמת מצבה מתאימה על קברנו וכן כל ההוצאות הכרוכות במתן צו לקיום צוואתנו.

4. כל עוד שנינו בחיים, לכל אחד מאיתנו נשמרת הזכות לבטל צוואה זו, על ידי הודעה בדבר הביטול בכתב לצד האחר. לא יהיה ניתן למסור הודעת ביטול, למי שהוכרז כי אינו מבין בדבר ומכאן, שבמצב זה לא ניתן להודיע על ביטול צוואה הדדית זו באופן חד צדדי.`,
    variables: ['marriage_year'],
    required: true,
    order: 2
  },

  {
    id: 'mutual-estate-scope',
    category: 'mutual',
    title: 'היקף העיזבון - צוואה הדדית',
    content: `במקרה ומי מאיתנו ילך לבית עולמו לפני רעהו, הרי שכל רכושו מכל מין וסוג שהוא בין במקרקעין, בין במיטלטלין, זכויות, ניירות ערך למיניהם, קופות גמל, קרנות השתלמות, ביטוחי חיים, פיקדונות וכל צורה אחרת, בין שהם קיימים היום ואנו יודעים על קיומם ובין שאינם קיימים היום או שאיננו יודעים על קיומם ויהיו שייכים לנו בעתיד, כספים במזומן ובבנקים, שיש לנו היום ושיהיו לנו בעתיד, המצויים ו/או מוחזקים בידי כל אדם ו/או גוף, בישראל ובכל מקום אחר בעולם ולרבות כל שיתווסף בעתיד- יעבור לנותר בחיים מבין שנינו. בין אם מופקדים בבנק/ים ובין אם בידי כל גורם/גורמים אחר/ים, וכן על זכויות אחרות מכל סוג שהוא, ו/או כל רכוש אחר שיהיו קיימים לנו היום או שייכים לנו בעתיד, לרבות:`,
    variables: [],
    required: true,
    order: 3
  },

  {
    id: 'mutual-inheritance-distribution',
    category: 'mutual',
    title: 'הוראות לחלוקת עזבוננו',
    content: `במקרה בו שנינו נלך לבית עולמנו בעת ובעונה אחת או לאחר פטירתו של זה מאיתנו שיאריך חיים מביננו, היננו קובעים ומצווים כי כל רכושנו, המצוין לעיל, יעבור ל{{heirs_description}} בחלוקה שווה.

כל המטלטלין שאינם מחוברים חיבור של קבע, אנו מצווים כי הם יחולקו באופן בו יסכימו {{number_of_children}} ילדינו המצוינים בסעיף {{reference_section}} לעיל. בקשתנו כי החלוקה ביניהם תעשה ברוח טובה.

התכשיטים יחולקו בין {{number_of_heirs}} היורשים כמפורט בסעיף {{reference_section}} לעיל בחלקים שווים, ובמקרה שתהיה מחלוקת בין היורשים על החלוקה תתבצע הגרלה לקביעת זכאותם, ואם לא ניתן לחלק את התכשיטים יימכרו והכסף יחולק בחלקים שווים.`,
    variables: ['heirs_description', 'number_of_children', 'number_of_heirs', 'reference_section'],
    required: true,
    order: 7
  },

  {
    id: 'mutual-vehicle-clause',
    category: 'mutual',
    title: 'סעיף רכב מיוחד',
    content: `במקרה של פטירת {{vehicle_owner}}, ובתנאי שהרכב מסוג {{vehicle_type}} מספר רישוי {{vehicle_plate}} עדיין קיים ורשום על שמה במועד הפטירה, זכויות הבעלות ברכב זה בלבד יועברו באופן מיידי ומוחלט ל{{vehicle_inheritor}} הנושאת ת.ז. {{vehicle_inheritor_id}} ללא תנאי וללא תמורה. הוראה זו חלה אך ורק על הרכב הספציפי הנ"ל.`,
    variables: ['vehicle_owner', 'vehicle_type', 'vehicle_plate', 'vehicle_inheritor', 'vehicle_inheritor_id'],
    required: false,
    order: 8
  },

  {
    id: 'mutual-residence-rights',
    category: 'mutual',
    title: 'זכויות מגורים לבן זוג נותר',
    content: `למען הסר ספק, ומבלי לגרוע מכלליות האמור לעיל בצוואה הדדית זו, מוסכם ומוצהר בזאת כי בן/בת הזוג אשר יאריך/תאריך ימים יהא/תהא זכאי/ת להמשיך ולהתגורר בדירת המגורים המשותפת באופן בלעדי ומוחלט, ללא כל הגבלת זמן ולמשך כל ימי חייו/חייה.

זכות המגורים האמורה תהא מוחלטת ובלתי מותנית, וכוללת את הזכות המלאה לעשות שימוש בלעדי בכל חלקי דירת המגורים המשותפת, תכולתה, וכל המיטלטלין המצויים בה, ללא צורך בקבלת הסכמה או אישור מצד כל אדם או גורם אחר, לרבות יורשים על פי דין ו/או על פי צוואה זו.

מובהר בזאת כי איש לא יהא רשאי להתערב בזכות המגורים האמורה, להגבילה, או לדרוש את פינוי בן/בת הזוג הנותר/ת מדירת המגורים המשותפת, וכל ניסיון להתערב בזכות זו יהא בטל מעיקרו.`,
    variables: [],
    required: false,
    order: 9
  },

  {
    id: 'mutual-property-restrictions',
    category: 'mutual',
    title: 'הגבלות על העברת נכסים',
    content: `מוסכם ומוצהר בזאת כי בן/בת הזוג אשר יאריך/תאריך ימים לאחר פטירת הראשון מביננו (להלן: "בן הזוג הנותר"), יהיה מנוע ומושתק מלהעביר ללא תמורה, בין במתנה ובין בכל דרך אחרת, את זכויותיו/זכויותיה, בין במלואן ובין בחלקן, בנכסי המקרקעין הבאים:

א. דירת המגורים הנוכחית המשותפת;
ב. זכויות בדירות המורשות; 
ג. כל דירה אחרת שתירכש בעתיד בנוסף לדירת המגורים המשותפת;
ד. כל דירה שתחליף את דירת המגורים המשותפת;
ה. כל זכות אחרת במקרקעין שתתקבל בעתיד בירושה או במתנה.

איסור ההעברה ללא תמורה כאמור יחול על העברה לכל אדם, לרבות אך לא רק:
1. קרובי משפחה מדרגה ראשונה, שנייה או כל דרגה אחרת;
2. ידוע/ה בציבור של בן הזוג הנותר;
3. בן/בת זוג עתידי/ת של בן הזוג הנותר;
4. תאגיד בשליטת מי מהנ"ל;
5. כל אדם או תאגיד אחר.`,
    variables: [],
    required: false,
    order: 10
  },

  {
    id: 'mutual-new-relationship',
    category: 'mutual',
    title: 'הוראות לקשר זוגי חדש',
    content: `במקרה שבן/בת הזוג הנותר/ת בחיים יקיים/תקיים קשר זוגי חדש, מוצהר ומוסכם בזאת כדלקמן:

א. בן/בת הזוג הנותר/ת מתחייב/ת לערוך הסכם ממון או הסכם לחיים משותפים עם בן/בת הזוג החדש/ה טרם תחילת החיים המשותפים;

ב. ההסכם יכלול הפרדה רכושית מוחלטת בין הצדדים;

ג. ההסכם יכלול הצהרה מפורשת של בן/בת הזוג החדש/ה כי הוא/היא מוותר/ת על כל זכות לירושה מבן/בת הזוג הנותר/ת בחיים;

ד. העתק מהסכם האמור יימסר ליורשים על פי צוואה זו תוך 30 ימים מחתימתו.`,
    variables: [],
    required: false,
    order: 11
  }
];

// סעיפים משותפים לשני הסוגים
export const commonWillSections: ProfessionalWillSection[] = [
  {
    id: 'cancel-previous-wills',
    category: 'both',
    title: 'ביטול צוואות קודמות',
    content: `למען הסר ספק, אני מבטל בזה ביטול גמור, מוחלט ושלם, כל צוואה ו/או הוראה שנתתי בעבר לפני תאריך חתימה על צוואה זו, בין בכתב ובין בעל פה בקשור לרכושי ולנכסיי, כל מסמך, או כתב, כל שיחה שבעל פה, שיש בה מעין גילוי דעת על מה שיש ברצוני שייעשה בעיזבוני לאחר מותי.`,
    variables: [],
    required: true,
    order: 2
  },

  {
    id: 'estate-debts',
    category: 'both',
    title: 'תשלום חובות העיזבון',
    content: `אני מורה ליורשיי אשר יבצעו את צוואתי לשלם מתוך עיזבוני האמור את כל חובותיי שיעמדו לפירעון בעת פטירתי, הוצאות הבאתי לארץ אם פטירתי תהא בחו"ל והוצאות קבורתי, כולל הקמת מצבה מתאימה על קברי וכן כל ההוצאות הכרוכות במתן צו לקיום צוואתי.`,
    variables: [],
    required: true,
    order: 3
  },

  {
    id: 'heir-death-scenario',
    category: 'both',
    title: 'מקרה פטירת יורש',
    content: `במקרה של פטירת אחד מהיורשים הנזכרים לעיל לפני פטירתי, חלקו יעבור ליורשיו החוקיים.`,
    variables: [],
    required: true,
    order: 12
  },

  {
    id: 'contest-clause',
    category: 'both',
    title: 'סעיף התנגדות מתקדם',
    content: `כל אדם שיהיה זכאי על פי צוואה זו, ויתנגד לה או יערער עליה בכל דרך שהיא, או יטען כנגד תוקפה או כנגד תנאי מתנאיה, או ינהל הליכים משפטיים במטרה לבטלה או לשנותה, יאבד את כלל זכויותיו לירושה על פי צוואה זו, ויקבל במקום זאת סכום סימלי של שקל אחד (₪1) בלבד. תשלום השקל האמור יהווה את מלוא זכותו בעזבוני, וזאת במקום כל זכות או טענה אחרת שתהיה לו בעזבוני. תנאי זה יחול גם על מי שפועל בשמו של היורש או מטעמו, וכן על כל מי שיסייע או יעודד התנגדות לצוואה זו.`,
    variables: [],
    required: true,
    order: 13
  },

  {
    id: 'cooperation-clause',
    category: 'both',
    title: 'סעיף שיתוף פעולה',
    content: `הנני מצווה, כי ביצוע וקיום צוואה זו יהא ברוח טובה בשיתוף פעולה הדדי בין היורשים.`,
    variables: [],
    required: true,
    order: 14
  },

  {
    id: 'final-declaration',
    category: 'both', 
    title: 'הצהרה חתימה סופית',
    content: `ולראיה באתי על החתום מרצוני הטוב והחופשי, בהיותי בדעה צלולה ולאחר שיקול דעת, בפני העדים הח"מ הנקובים בשמותיהם וכתובותיהם ולאחר שהצהרתי בנוכחות שני עדי הצוואה המפורטים להלן כי זו צוואתי.`,
    variables: [],
    required: true,
    order: 15
  }
];

/**
 * מחסן סעיפים לשימוש עורכי דין
 */
export interface SectionTemplate {
  id: string;
  title: string;
  category: 'property' | 'inheritance' | 'restrictions' | 'special' | 'family' | 'business';
  content: string;
  variables: string[];
  aiPrompt: string;
  usageInstructions: string;
}

export const sectionsWarehouse: SectionTemplate[] = [
  // נכסים דיגיטליים - מהדוגמה של קלוד
  {
    id: 'digital-assets-full',
    title: 'נכסים דיגיטליים מפורט',
    category: 'property',
    content: `אני מורה בזה כי כל נכסיי הדיגיטליים, בכל מקום בו הם נמצאים ובכל פלטפורמה או מדיום דיגיטלי, יעברו ל{{digital_heir}} לרשותו המלאה והבלעדית.

לצורך הוראה זו, נכסים דיגיטליים משמעם כל המידע, הנתונים, הקבצים והתכנים השמורים במכשירי האלקטרוניים שלי או בחשבונות דיגיטליים הרשומים על שמי.

אני מצווה במפורש כי כל הנכסים הדיגיטליים הנ"ל יישמרו ולא יימחקו או יושמדו.

הנכסים הדיגיטליים כוללים, בין השאר, את כל המידע הקיים בטלפון הנייד ובמחשב שלי, לרבות:
- מסמכים דיגיטליים מכל סוג שהוא
- הודעות דואר אלקטרוני (דוא"ל) 
- תמונות ואלבומי תמונות
- ספריית Google Drive ושירותי אחסון ענן אחרים
- הודעות SMS ו-WhatsApp
- קבצי אודיו ווידאו
- יומנים דיגיטליים ואפליקציות`,
    variables: ['digital_heir'],
    aiPrompt: 'הרחב וכתוב סעיף מפורט על נכסים דיגיטליים בעברית משפטית תקינה - חשבונות, קבצים, מידע, קריפטו',
    usageInstructions: 'שימוש במקרה שיש נכסים דיגיטליים חשובים - חשבונות, מידע, קריפטו'
  },

  // ירושת עסק מקצועי
  {
    id: 'business-inheritance-full',
    title: 'ירושת עסק מלא',
    category: 'business',
    content: `אני מורה בזה כי עסקי {{business_name}} ח.פ. {{business_id}}, לרבות כל הזכויות, הרישיונות, הלקוחות, המלאי, הציוד וכל הנכסים הקשורים לעסק, יעברו ל{{business_heir}} שיהיה אחראי לניהולו והמשך פעילותו.

{{business_heir}} מתחייב לשמור על רמת השירות ועל שם הטוב של העסק, ויהיה אחראי לכל החובות והתחייבויות העסקיות הקיימות במועד פטירתי.

שאר היורשים יהיו זכאים לקבלת דו"ח כספי שנתי על פעילות העסק ורווחיותו, אך לא תהיה להם זכות התערבות בניהולו.

במקרה שהעסק יסגר או יימכר, התמורה תחולק בין כלל היורשים לפי החלוקה הקבועה בצוואתי זו.`,
    variables: ['business_name', 'business_id', 'business_heir'],
    aiPrompt: 'כתוב סעיף מפורט לירושת עסק בעברית משפטית - זכויות, חובות, ניהול, רישיונות',
    usageInstructions: 'לשימוש כאשר המצווה הוא בעל עסק ורוצה להעביר אותו ליורש ספציפי'
  },

  // העברת רכב ספציפי - מהדוגמה של קלוד
  {
    id: 'specific-vehicle-transfer',
    title: 'העברת רכב ספציפי',
    category: 'property',
    content: `במקרה של פטירת {{vehicle_owner}}, ובתנאי שהרכב מסוג {{vehicle_type}} מספר רישוי {{vehicle_plate}} עדיין קיים ורשום על שמו/ה במועד הפטירה, זכויות הבעלות ברכב זה בלבד יועברו באופן מיידי ומוחלט ל{{vehicle_inheritor}} הנושא/ת ת.ז. {{vehicle_inheritor_id}}, ללא תנאי וללא תמורה. הוראה זו חלה אך ורק על הרכב הספציפי הנ"ל.`,
    variables: ['vehicle_owner', 'vehicle_type', 'vehicle_plate', 'vehicle_inheritor', 'vehicle_inheritor_id'],
    aiPrompt: 'כתוב סעיף מפורט להעברת רכב ספציפי ליורש מסוים - פרטי רכב, יורש, תנאים',
    usageInstructions: 'לשימוש כאשר רוצים להעביר רכב ספציפי ליורש מסוים ולא לכולם'
  },

  // איסור התנגדות מתקדם - מהדוגמה של קלוד
  {
    id: 'advanced-contest-clause',
    title: 'סעיף התנגדות מתקדם',
    category: 'restrictions',
    content: `כל אדם שיהיה זכאי על פי צוואה זו, ויתנגד לה או יערער עליה בכל דרך שהיא, או יטען כנגד תוקפה או כנגד תנאי מתנאיה, או ינהל הליכים משפטיים במטרה לבטלה או לשנותה, יאבד את כלל זכויותיו לירושה על פי צוואה זו, ויקבל במקום זאת סכום סימלי של שקל אחד (₪1) בלבד.

תשלום השקל האמור יהווה את מלוא זכותו בעזבוני, וזאת במקום כל זכות או טענה אחרת שתהיה לו בעזבוני.

תנאי זה יחול גם על מי שפועל בשמו של היורש או מטעמו, וכן על כל מי שיסייע או יעודד התנגדות לצוואה זו.`,
    variables: [],
    aiPrompt: 'כתוב סעיף מתקדם נגד התנגדות לצוואה - עונשים, הגבלות, הרתעה',
    usageInstructions: 'לשימוש כאשר רוצים מירב ההגנה נגד ערעורים והתנגדויות לצוואה'
  },

  // הגבלות על העברת נכסים - מהדוגמה של קלוד
  {
    id: 'property-transfer-restrictions', 
    title: 'הגבלות על העברת נכסים',
    category: 'restrictions',
    content: `מוסכם ומוצהר בזאת כי בן/בת הזוג אשר יאריך/תאריך ימים לאחר פטירת הראשון מביננו (להלן: "בן הזוג הנותר"), יהיה מנוע ומושתק מלהעביר ללא תמורה, בין במתנה ובין בכל דרך אחרת, את זכויותיו/זכויותיה, בין במלואן ובין בחלקן, בנכסי המקרקעין הבאים:

א. דירת המגורים הנוכחית המשותפת;
ב. זכויות בדירות המורשות;
ג. כל דירה אחרת שתירכש בעתיד בנוסף לדירת המגורים המשותפת;
ד. כל דירה שתחליף את דירת המגורים המשותפת;
ה. כל זכות אחרת במקרקעין שתתקבל בעתיד בירושה או במתנה.

איסור ההעברה ללא תמורה כאמור יחול על העברה לכל אדם, לרבות אך לא רק:
1. קרובי משפחה מדרגה ראשונה, שנייה או כל דרגה אחרת;
2. ידוע/ה בציבור של בן הזוג הנותר;
3. בן/בת זוג עתידי/ת של בן הזוג הנותר;
4. תאגיד בשליטת מי מהנ"ל;
5. כל אדם או תאגיד אחר.`,
    variables: [],
    aiPrompt: 'כתוב סעיף מפורט להגבלות על העברת נכסים - איסורים, מקרים, עונשים',
    usageInstructions: 'לשימוש בצוואה הדדית למניעת העברת נכסים ללא תמורה'
  },

  // קופות גמל וביטוחים
  {
    id: 'pension-insurance-funds',
    title: 'קופות גמל וביטוחים',
    category: 'property',
    content: `כל זכויות החיסכון והביטוח המצויות בקופות הגמל, קרנות הפנסיה, קופות התגמולים, קרנות ההשתלמות, תוכניות החיסכון, פוליסות ביטוח החיים וכל מוצר פיננסי אחר (להלן: "הקופות") ישולמו למוטבים הרשומים בקופות במועד הפטירה, וזאת בהתאם לרישום בפועל בקופות במועד הפטירה.

עם זאת, ככל שבמועד הפטירה לא יהיו רשומים מוטבים בקופה כלשהי, או שהמוטבים הרשומים נפטרו לפני המוריש ולא עודכנו מוטבים חלופיים, או שמסיבה כלשהי לא ניתן יהיה לשלם את הכספים למוטבים הרשומים, אזי כספי אותה קופה ייחשבו כחלק מהעיזבון ויחולקו בהתאם להוראות סעיף 6 לצוואה זו.`,
    variables: [],
    aiPrompt: 'כתוב סעיף מפורט על קופות גמל וביטוחים - מוטבים, חוסר מוטבים, הוראות חלופיות',
    usageInstructions: 'לשימוש כאשר יש קופות גמל וביטוחי חיים עם מוטבים'
  },

  // זכות מגורים לבן זוג נותר
  {
    id: 'spouse-residence-rights',
    title: 'זכות מגורים לבן זוג נותר',
    category: 'family',
    content: `למען הסר ספק, ומבלי לגרוע מכלליות האמור לעיל בצוואה הדדית זו, מוסכם ומוצהר בזאת כי בן/בת הזוג אשר יאריך/תאריך ימים יהא/תהא זכאי/ת להמשיך ולהתגורר בדירת המגורים המשותפת באופן בלעדי ומוחלט, ללא כל הגבלת זמן ולמשך כל ימי חייו/חייה.

זכות המגורים האמורה תהא מוחלטת ובלתי מותנית, וכוללת את הזכות המלאה לעשות שימוש בלעדי בכל חלקי דירת המגורים המשותפת, תכולתה, וכל המיטלטלין המצויים בה, ללא צורך בקבלת הסכמה או אישור מצד כל אדם או גורם אחר, לרבות יורשים על פי דין ו/או על פי צוואה זו.

מובהר בזאת כי איש לא יהא רשאי להתערב בזכות המגורים האמורה, להגבילה, או לדרוש את פינוי בן/בת הזוג הנותר/ת מדירת המגורים המשותפת, וכל ניסיון להתערב בזכות זו יהא בטל מעיקרו.`,
    variables: [],
    aiPrompt: 'כתוב סעיף מפורט לזכות מגורים של בן זוג נותר - זכויות, הגנות, איסור הפרעה',
    usageInstructions: 'לשימוש בצוואה הדדית להבטחת זכות מגורים לבן הזוג הנותר'
  },

  // הוראות לקשר זוגי חדש - מהדוגמה של קלוד
  {
    id: 'new-relationship-terms',
    title: 'הוראות לקשר זוגי חדש',
    category: 'family',
    content: `במקרה שבן/בת הזוג הנותר/ת בחיים יקיים/תקיים קשר זוגי חדש, מוצהר ומוסכם בזאת כדלקמן:

א. בן/בת הזוג הנותר/ת מתחייב/ת לערוך הסכם ממון או הסכם לחיים משותפים עם בן/בת הזוג החדש/ה טרם תחילת החיים המשותפים;

ב. ההסכם יכלול הפרדה רכושית מוחלטת בין הצדדים;

ג. ההסכם יכלול הצהרה מפורשת של בן/בת הזוג החדש/ה כי הוא/היא מוותר/ת על כל זכות לירושה מבן/בת הזוג הנותר/ת בחיים;

ד. העתק מהסכם האמור יימסר ליורשים על פי צוואה זו תוך 30 ימים מחתימתו.

ההסכם יהיה בלתי הדיר. אי עריכת הסכם כאמור או הפרת תנאיו תהווה הפרה יסודית של הצוואה ההדדית, ובמקרה כזה יהיו היורשים רשאים לנקוט בכל האמצעים המשפטיים להגנת זכויותיהם.`,
    variables: [],
    aiPrompt: 'כתוב סעיף מפורט להוראות בנוגע לקשר זוגי חדש - הסכם ממון, הפרדה רכושית, הגנות',
    usageInstructions: 'לשימוש בצוואה הדדית להגנה על הירושה במקרה של קשר זוגי חדש'
  },

  // מכירת דירת מגורים ורכישת חלופית
  {
    id: 'residence-sale-replacement',
    title: 'מכירת דירת מגורים ורכישת חלופית',
    category: 'restrictions',
    content: `מוסכם ומוצהר בזאת כי במקרה של מכירת דירת המגורים המשותפת, חובה על בן הזוג הנותר לרכוש דירת מגורים חלופית בסכום שלא יפחת מ-{{replacement_percentage}}% מתמורת המכירה נטו של הדירה הנמכרת.

רכישת הדירה החלופית תתבצע בתוך {{replacement_days}} ימים ממועד קבלת תמורת המכירה.

עם רכישת הדירה החלופית, תירשם הערת אזהרה לטובת היורשים בלשכת רישום המקרקעין תוך {{warning_days}} ימים מיום הרכישה, וזאת בהתאם לחלוקה המפורטת בסעיף {{reference_section}} לעיל.`,
    variables: ['replacement_percentage', 'replacement_days', 'warning_days', 'reference_section'],
    aiPrompt: 'כתוב סעיף מפורט למכירת דירת מגורים ורכישת חלופית - אחוזים, מועדים, הגנות',
    usageInstructions: 'לשימוש בצוואה הדדית להגבלה על מכירת דירת המגורים'
  },

  // איסור מכירת דירות מורשות
  {
    id: 'inherited-properties-restrictions',
    title: 'איסור מכירת דירות מורשות',
    category: 'restrictions',
    content: `לאחר פטירתו של הראשון מבין בני הזוג, חל איסור מוחלט על בן הזוג הנותר בחיים למכור, להעביר, למשכן, לשעבד או לבצע כל עסקה או פעולה משפטית בדירות שהתקבלו בירושה.

מיד לאחר פטירת הראשון מבין בני הזוג, על היורשים לפעול לרישום הערת אזהרה בלשכת רישום המקרקעין על כל אחת מהדירות המורשות, אשר תמנע כל עסקה בנכסים אלה. הערות האזהרה תירשמנה לטובת היורשים על פי צוואה זו.

בן הזוג הנותר בחיים יהיה רשאי להתגורר בדירות המורשות ולהשתמש בהן לצרכיו האישיים, לרבות השכרתן וקבלת דמי השכירות, אך לא יהיה רשאי לבצע כל פעולה הפוגעת בקניין עצמו.`,
    variables: [],
    aiPrompt: 'כתוב סעיף מפורט לאיסור מכירת נכסים שהתקבלו בירושה - הגבלות, הערות אזהרה',
    usageInstructions: 'לשימוש בצוואה הדדית כאשר יש נכסים שהתקבלו בירושה ורוצים להגן עליהם'
  },

  // מסר אישי לילדים - מהדוגמה של קלוד
  {
    id: 'personal-message-children',
    title: 'מסר אישי לילדים',
    category: 'family',
    content: `ילדינו היקרים,

אהבתנו אליכם חזקה מכל מילה שנוכל לכתוב. כל אחד מכם הוא עולם ומלואו בעינינו, אור שמאיר את חיינו ומקור לגאווה אינסופית.

גידלנו אתכם באהבה, וזכינו לראות אתכם גדלים, מתפתחים והופכים לאנשים מדהימים. הזיכרונות המשותפים שלנו, הצחוק, החיבוקים, השיחות, ואפילו הרגעים הקשים שעברנו יחד, הם האוצר הגדול ביותר שלנו.

בקשתנו העמוקה היא שתמשיכו לאהוב זה את זה, לתמוך זה בזה ולהיות שם אחד בשביל השני. הקשר ביניכם כאחים הוא מתנה יקרה, שמרו עליו, טפחו אותו, והיו זה לזה משענת בימים של שמחה ושל עצב.

זכרו תמיד: בכל צעד שתצעדו בחייכם, באשר תהיו, רוחנו תלווה אתכם ואהבתנו תחבק אתכם. אתם הייתם ותמיד תהיו הדבר הכי יקר לנו בעולם.

באהבה עמוקה ונצחית,
{{parent_names}}`,
    variables: ['parent_names'],
    aiPrompt: 'כתוב מסר אישי ואהוב להורים לילדיהם בצוואה - אהבה, זיכרונות, ברכות',
    usageInstructions: 'לשימוש בצוואה הדדית להוספת מסר אישי ומרגש לילדים'
  },

  // אי הכללה מכוונת - מהדוגמה של קלוד  
  {
    id: 'intentional-exclusion',
    title: 'אי הכללה מכוונת',
    category: 'special',
    content: `כל אדם שלא נכלל בירושתי על פי צוואה זו, כולל נכסים ו/או כספים - הדבר נעשה במכוון ולא מחמת טעות או שכחה. החלטותיי נתקבלו לאחר שיקול דעת מושכל ומתוך רצון חופשי וללא כפייה.

אני מבקש/ת בזאת מכל הנוגעים בדבר, לכבד החלטה זו ולמלא אחר הוראותיי המפורטות בצוואה זו.

{{#if excluded_person}}
למען הסר ספק, אני מבהיר/ה במפורש כי {{excluded_person}}, אינו/ה זכאי/ת לקבל מאומה מן הירושה שלי, לא על פי דין ולא על פי צוואתי זו, הוא/היא אינו/ה יורש/ת חוקי/ת שלי בשום דרך שהיא, ואני שולל/ת ממנו/ה במפורש ובאופן סופי כל זכות, טענה, תביעה או דרישה לירושה ממני, בין במישרין ובין בעקיפין.
{{/if}}`,
    variables: ['excluded_person'],
    aiPrompt: 'כתוב סעיף מפורט לאי הכללה מכוונת של אדם מסוים - הבהרות, שלילת זכויות',
    usageInstructions: 'לשימוש כאשר רוצים לשלול זכויות ירושה מאדם מסוים במפורש'
  },

  // טיפול בחיות מחמד מתקדם
  {
    id: 'pet-care-advanced',
    title: 'טיפול בחיות מחמד מתקדם',
    category: 'special',
    content: `אני מורה בזה כי חיות המחמד שלי: {{pets_list}}, יועברו לטיפולו של {{pet_caregiver}} שיהיה אחראי לטיפול, מזון, טיפול וטרינרי וכל הצרכים הנדרשים.

לצורך זה, אני מוריש סכום של {{pet_care_amount}} ש"ח שיועבר ל{{pet_caregiver}} למטרת טיפול בחיות המחמד. הכסף יועבר בתשלומים חודשיים של {{monthly_amount}} ש"ח או לפי הצורך לטיפול וטרינרי.

{{pet_caregiver}} מתחייב לטפל בחיות באהבה ובמסירות, לספק להן מזון איכותי, טיפול וטרינרי שוטף וחירום, ולהעניק להן בית חם ואוהב.

במקרה ש{{pet_caregiver}} לא יוכל להמשיך לטפל בהן, עליו למצוא בית חם ואוהב אחר לחיות, ולהודיע לכל היורשים על ההעברה. אסור בהחלט להעביר את החיות למקלט או לוותר עליהן.

יתרת הכספים שלא נוצלו לטיפול בחיות תחזור לעיזבון לחלוקה בין היורשים.`,
    variables: ['pets_list', 'pet_caregiver', 'pet_care_amount', 'monthly_amount'],
    aiPrompt: 'כתוב סעיף מפורט לטיפול בחיות מחמד - תקציב, חובות המטפל, תנאים',
    usageInstructions: 'לשימוש כאשר למצווה יש חיות מחמד חשובות שדורשות טיפול מיוחד'
  },

  // תרומה לצדקה מתקדמת
  {
    id: 'charity-bequest-advanced',
    title: 'הוראה לתרומה מתקדמת',
    category: 'special',
    content: `אני מורה בזה כי סכום של {{donation_amount}} ש"ח ({{donation_amount_words}}) יועבר כתרומה ל{{charity_name}} ע.ר. {{charity_id}}, הפועל בתחום {{charity_field}}.

תרומה זו תשולם מתוך עיזבוני לפני חלוקת היתרה ליורשים, ותהווה ביטוי לערכיי ולמחויבותי החברתית לקידום {{charity_cause}}.

התרומה תועבר תוך {{donation_timeframe}} מקבלת צו קיום צוואה, ו{{charity_name}} יידרש להמציא אישור על קבלת התרומה ועל השימוש בה למטרות הארגון.

במקרה שהארגון הנ"ל יפסיק לפעול או יאבד את מעמדו כארגון ציבורי, התרומה תועבר לארגון צדקה דומה בתחום {{charity_field}} שייבחר על ידי רוב היורשים.

אם לא יימצא ארגון חלופי מתאים, הסכום יחזור לחלוקה בין היורשים.`,
    variables: ['donation_amount', 'donation_amount_words', 'charity_name', 'charity_id', 'charity_field', 'charity_cause', 'donation_timeframe'],
    aiPrompt: 'כתוב סעיף מפורט לתרומה צדקה בצוואה - סכום, ארגון, הוראות ביצוע, תנאים',
    usageInstructions: 'לשימוש כאשר המצווה רוצה לתרום חלק מהעיזבון לצדקה בצורה מקצועית'
  }
];

/**
 * פונקציה לקבלת כל הסעיפים הרלוונטיים לסוג צוואה
 */
export function getSectionsForWillType(willType: 'individual' | 'mutual'): ProfessionalWillSection[] {
  let sections: ProfessionalWillSection[] = [];
  
  // סעיפים משותפים
  sections = sections.concat(commonWillSections);
  
  // סעיפים ספציפיים
  if (willType === 'individual') {
    sections = sections.concat(individualWillSections);
  } else {
    sections = sections.concat(mutualWillSections);
  }
  
  // מיון לפי סדר
  return sections.sort((a, b) => a.order - b.order);
}

/**
 * פונקציה ליצירת מספור תתי-סעיפים (1.1, 1.2, 5.1...)
 */
export function addSubSectionNumbering(content: string, mainSectionNumber: number, items: any[]): string {
  let result = '';
  items.forEach((item, index) => {
    result += `${mainSectionNumber}.${index + 1}. ${item}\n\n`;
  });
  return result;
}

/**
 * פונקציה להמרת טקסט מיחיד לרבים עבור צוואות הדדיות
 */
export function convertToPlural(text: string): string {
  return text
    // המרת כינויים
    .replace(/\bאני\b/g, 'אנחנו')
    .replace(/\bאנוכי\b/g, 'אנחנו')
    .replace(/\bשלי\b/g, 'שלנו')
    .replace(/\bרכושי\b/g, 'רכושנו')
    .replace(/\bנכסיי\b/g, 'נכסינו')
    .replace(/\bעיזבוני\b/g, 'עיזבוננו')
    .replace(/\bצוואתי\b/g, 'צוואתנו')
    .replace(/\bחובותיי\b/g, 'חובותינו')
    .replace(/\bיורשיי\b/g, 'יורשינו')
    .replace(/\bהוראותיי\b/g, 'הוראותינו')
    .replace(/\bפטירתי\b/g, 'פטירתנו')
    .replace(/\bמותי\b/g, 'מותנו')
    .replace(/\bקברי\b/g, 'קברנו')
    .replace(/\bזכרי\b/g, 'זכרנו')
    .replace(/\bביתי\b/g, 'ביתנו')
    .replace(/\bברשותי\b/g, 'ברשותנו')
    .replace(/\bבבעלותי\b/g, 'בבעלותנו')
    .replace(/\bלידיי\b/g, 'לידינו')
    .replace(/\bעליי\b/g, 'עלינו')
    .replace(/\bעלי\b/g, 'עלינו')
    
    // המרת פעלים ליחיד לרבים
    .replace(/\bהנני\b/g, 'הננו')
    .replace(/\bברצוני\b/g, 'ברצוננו')
    .replace(/\bמצווה\b/g, 'מצווים')
    .replace(/\bמורישה\b/g, 'מורישים')
    .replace(/\bמוריש\b/g, 'מורישים')
    .replace(/\bמצהירה\b/g, 'מצהירים')
    .replace(/\bמצהיר\b/g, 'מצהירים')
    .replace(/\bקובעת\b/g, 'קובעים')
    .replace(/\bקובע\b/g, 'קובעים')
    .replace(/\bמבטלת\b/g, 'מבטלים')
    .replace(/\bמבטל\b/g, 'מבטלים')
    .replace(/\bמורה\b/g, 'מורים')
    .replace(/\bמציינת\b/g, 'מציינים')
    .replace(/\bמציין\b/g, 'מציינים')
    .replace(/\bמבהירה\b/g, 'מבהירים')
    .replace(/\bמבהיר\b/g, 'מבהירים')
    .replace(/\bמוסיפה\b/g, 'מוסיפים')
    .replace(/\bמוסיף\b/g, 'מוסיפים')
    .replace(/\bממנה\b/g, 'ממנים')
    .replace(/\bמבקשת\b/g, 'מבקשים')
    .replace(/\bמבקש\b/g, 'מבקשים')
    .replace(/\bרוצה\b/g, 'רוצים')
    .replace(/\bחתמתי\b/g, 'חתמנו')
    .replace(/\bנתתי\b/g, 'נתנו')
    
    // המרת ביטויים מורכבים
    .replace(/\bבהיותי\b/g, 'בהיותנו')
    .replace(/\bלאחר שיקול דעת\b/g, 'לאחר שיקול דעת')
    .replace(/\bבדעה צלולה\b/g, 'בדעה צלולה')
    .replace(/\bבכושר גמור\b/g, 'בכושר גמור')
    .replace(/\bבדעה מוגמרת\b/g, 'בדעה מוגמרת')
    .replace(/\bמרצוני הטוב\b/g, 'מרצוננו הטוב')
    .replace(/\bהח"מ\b/g, 'הח"מ');
}

/**
 * פונקציה ליצירת תוכן צוואה מלא עם הטקסטים המקצועיים
 */
export function generateProfessionalWillContent(
  willType: 'individual' | 'mutual',
  data: Record<string, any>,
  selectedSections: string[]
): string {
  const sections = getSectionsForWillType(willType);
  let content = '';
  let sectionNumber = 1;
  
  // כותרת
  content += willType === 'mutual' ? 'צוואה הדדית\n\n' : 'צוואה\n\n';
  
  sections.forEach(section => {
    if (selectedSections.includes(section.id)) {
      let sectionContent = section.content;
      
      // החלפת משתנים
      section.variables.forEach(variable => {
        const regex = new RegExp(`{{${variable}}}`, 'g');
        const value = data[variable] || `[${variable}]`;
        sectionContent = sectionContent.replace(regex, value);
      });
      
      // החלפת נטיות מגדר
      if (data.gender === 'female') {
        sectionContent = sectionContent.replace(/{{gender:([^|]*)\|([^}]*)}}/g, '$2');
        sectionContent = sectionContent.replace(/{{gender:([^}]*)}}/g, '$1');
      } else {
        sectionContent = sectionContent.replace(/{{gender:([^|]*)\|([^}]*)}}/g, '$1');
        sectionContent = sectionContent.replace(/{{gender:([^}]*)}}/g, '');
      }
      
      // הוספה לתוכן
      if (section.title.includes('פתיחת') || section.title.includes('הוראות לחלוקת') || section.title.includes('היקף')) {
        // סעיפים מיוחדים ללא מספר
        content += sectionContent + '\n\n';
      } else {
        // סעיפים רגילים עם מספור
        content += `${sectionNumber}. ${sectionContent}\n\n`;
        sectionNumber++;
      }
    }
  });
  
  return content.trim();
}
