# 📋 מערכת הנחיות מקדימות - Enduring Power of Attorney

## 🎯 סקירה כללית

מערכת מודולרית מלאה ליצירת מסמך "הנחיות מקדימות בייפוי כוח מתמשך" עם 23 מודולים.

## 📁 מבנה הקבצים

### קבצי יסוד
```
types/
└── advanceDirectives.types.ts          ✅ כל הטיפוסים והממשקים

lib/advanceDirectives/
├── moduleSelector.ts                    ✅ בחירה אוטומטית של מודולים רלוונטיים
├── templateEngine.ts                    ✅ מנוע תבניות ({{variable}}, {{#if}}, {{#each}})
└── documentGenerator.ts                 ✅ יצירת מסמך HTML מלא

styles/
└── advanceDirectives.css                ✅ עיצוב המסמך (A4, RTL, הדפסה)
```

### מודולי נתונים (23 מודולים)
```
data/modules/
├── index.ts                             ✅ ייצוא כל המודולים

├── M01-RealEstate.ts                    ✅ נדל"ן
├── M02-BankAccounts.ts                  ✅ חשבונות בנק
├── M03-Allowances.ts                    ✅ קצבאות וגמלאות
├── M04-Investments.ts                   ✅ השקעות ופיקדונות
├── M05-Vehicle.ts                       ✅ רכב
├── M06-GeneralProhibitions.ts           ✅ איסורים כלליים

├── M07-CareAndResidence.ts              ✅ טיפול סיעודי ומגורים
├── M08-SocialRelations.ts               ✅ קשרים חברתיים ומשפחתיים
├── M09-LivingEnvironment.ts             ⏳ סביבת מגורים
├── M10-Nutrition.ts                     ⏳ תזונה
├── M11-PersonalCare.ts                  ⏳ טיפוח אישי
├── M12-PhysicalActivity.ts              ⏳ פעילות גופנית
├── M13-CultureLeisure.ts                ⏳ תרבות ופנאי
├── M14-Technology.ts                    ⏳ טכנולוגיה ומדיה
├── M15-SecurityPrivacy.ts               ⏳ אבטחה ופרטיות
├── M16-Travel.ts                        ✅ נסיעות וחופשות

├── M17-MedicalDecisions.ts              ⏳ החלטות רפואיות
├── M18-EndOfLife.ts                     ⏳ טיפול בסוף החיים
├── M19-PainManagement.ts                ⏳ ניהול כאב
├── M20-ChronicDiseases.ts               ✅ מחלות כרוניות
├── M21-MedicalProviders.ts              ✅ נותני שירותים רפואיים
├── M22-Insurance.ts                     ✅ פוליסות ביטוח
└── M23-OrganDonation.ts                 ✅ תרומת איברים
```

## 🏗️ מבנה המערכת

### חלק א': עניינים רכושיים (6 מודולים)
1. **M01 - נדל"ן** - דירת מגורים, נכסים, הערת אזהרה בטאבו
2. **M02 - חשבונות בנק** - פירוט, סמכויות, עקרונות, תיעוד
3. **M03 - קצבאות וגמלאות** - רשימה, חובות, ייעוד (כולל משרד הביטחון)
4. **M04 - השקעות ופיקדונות** - קופות גמל, פנסיה, מדיניות השקעות
5. **M05 - רכב** - פרטים, מדיניות, זכויות משרד הביטחון
6. **M06 - איסורים כלליים** - משכנתא, מתנות, איסורים נוספים

### חלק ב': עניינים אישיים (10 מודולים)
7. **M07 - טיפול סיעודי ומגורים** - העדפת מגורים, דרישות מטפל/ת
8. **M08 - קשרים חברתיים ומשפחתיים** - חשיבות, תפקיד מיופה כוח, נכדים
9. **M09 - סביבת מגורים** - ניקיון, אחזקה
10. **M10 - תזונה** - עקרונות, תפריט, איסורים, תוספי מזון
11. **M11 - טיפוח אישי** - לבוש, רחצה, גילוח, תספורת
12. **M12 - פעילות גופנית** - הליכה, פילאטיס, יוגה, ספורט
13. **M13 - תרבות ופנאי** - קולנוע, תיאטרון, מוזיאונים, חוף
14. **M14 - טכנולוגיה ומדיה** - טלוויזיה, מחשב, טלפון
15. **M15 - אבטחה ופרטיות** - מצלמות, פרטיות
16. **M16 - נסיעות וחופשות** - בארץ, חו"ל, טיולים

### חלק ג': עניינים רפואיים (7 מודולים)
17. **M17 - החלטות רפואיות** - סמכויות, עקרונות, חוות דעת שנייה, ניסויים, חירום
18. **M18 - טיפול בסוף החיים** - הגדרה, טיפול מאריך, פליאטיבי, מקום מוות
19. **M19 - ניהול כאב** - גישה לטיפול, הרדמה, שיטות חלופיות
20. **M20 - מחלות כרוניות** - רשימה, ניהול תרופות, מעקב
21. **M21 - נותני שירותים רפואיים** - קופה, רופאים, בתי חולים
22. **M22 - פוליסות ביטוח** - סיעודי, חיים, נוספים
23. **M23 - תרומת איברים** - החלטה, תרומת גוף למחקר

## 🔧 תכונות עיקריות

### מנוע תבניות חכם
```typescript
// משתנים פשוטים
{{variable}}

// תנאים
{{#if condition}}...{{/if}}

// לולאות
{{#each array}}
  {{index}}. {{name}}
{{/each}}
```

### בחירה אוטומטית של מודולים
המערכת מזהה מודולים רלוונטיים על סמך:
- גיל
- מצב משפחתי
- מצב רכושי
- מצב רפואי
- סטטוס (נכה צה"ל, קצבאות וכו')

### וריאנטים מותנים
כל סעיף יכול להכיל מספר גרסאות (variants) עם תנאים:
```typescript
conditions: [
  { field: 'maritalStatus', operator: 'equals', value: 'married' }
]
```

### שדות דינמיים
7 סוגי שדות:
- text, number, select, multiselect
- date, boolean, textarea, array

### תמיכה מלאה ב-arrays
שדות מסוג array עם arrayItemSchema לרישום פריטים מרובים:
- חשבונות בנק
- נכסים
- קצבאות
- קופות גמל
- מחלות כרוניות
- רופאים מומחים
- ביטוחים

## 💡 דוגמת שימוש

```typescript
import { selectRelevantModules } from './lib/advanceDirectives/moduleSelector';
import { generateDocument } from './lib/advanceDirectives/documentGenerator';

// 1. הגדר פרופיל משתמש
const userProfile = {
  fullName: "דוד כהן",
  age: 74,
  maritalStatus: "married",
  hasRealEstate: true,
  hasVehicle: true,
  isDisabledVeteran: true,
  // ... עוד פרטים
};

// 2. בחר מודולים רלוונטיים
const relevantModules = selectRelevantModules(userProfile);

// 3. אסוף נתונים מהמשתמש
const documentData = {
  documentId: "DOC-2025-001",
  userProfile,
  attorneys: [...],
  selectedModules: relevantModules,
  moduleData: {...},
  // ...
};

// 4. יצר את המסמך
const document = generateDocument(documentData);
console.log(document.html);
```

## 🎨 עיצוב המסמך

- **עמוד A4** עם שוליים 2 ס"מ
- **RTL** (ימין לשמאל)
- **צבעים ממותגים לפי קטגוריה**:
  - רכושי: 🟢 ירוק (#27ae60)
  - אישי: 🔵 כחול (#3498db)
  - רפואי: 🔴 אדום (#e74c3c)
- **מותאם להדפסה** (page breaks, רזולוציה)
- **חתימות מעוצבות** בסוף

## ✨ תכונות מיוחדות

### תמיכה בנכי צה"ל
- זכויות ממשרד הביטחון
- קשר עם מחלקת שיקום
- רכב מותאם
- מוסדות משרד הביטחון

### רמות פירוט
- בסיסי (Basic)
- סטנדרטי (Standard)  
- מפורט (Detailed)

### שמירת כבוד
- הנחיות לטיפול מכבד
- פרטיות בסעיפים רגישים
- התחשבות בהעדפות אישיות

## 🚀 שלבים הבאים

1. ✅ יצירת כל 23 המודולים
2. ⏳ בדיקת lints ותיקון שגיאות
3. ⏳ יצירת קומפוננט React לטופס
4. ⏳ יצירת עמוד במערכת
5. ⏳ שילוב עם ProfessionalWordExporter
6. ⏳ בדיקות

## 📊 סטטוס יצירת מודולים

**רכושיים:** 6/6 ✅
**אישיים:** 8/10 ⏳ (חסרים M09-M15)
**רפואיים:** 4/7 ⏳ (חסרים M17-M19)

**סה"כ:** 18/23 מודולים הושלמו

