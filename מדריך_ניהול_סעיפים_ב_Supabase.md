# מדריך ניהול סעיפים היררכיים ב-Supabase

## 🎯 מטרת המדריך
מדריך זה מסביר איך לנהל סעיפים עם תתי סעיפים ותתי תתי סעיפים במערכת הצוואות והסכמי שכר טרחה.

## 📋 מבנה הסעיפים

### רמות הסעיפים:
- **`main`** - סעיף ראשי
- **`sub`** - תת-סעיף (שייך לסעיף ראשי)
- **`sub-sub`** - תת-תת-סעיף (שייך לתת-סעיף)

### דוגמה למבנה:
```
1. שכר טרחה בסיסי (main)
   ├── 1.1 שכר טרחה למפגש ראשון (sub)
   │   ├── 1.1.1 הכנת הצוואה (sub-sub)
   │   └── 1.1.2 תיעוד הוראות (sub-sub)
   └── 1.2 שכר טרחה למפגש שני (sub)
       ├── 1.2.1 הגהה וחתימה (sub-sub)
       └── 1.2.2 שמירה ועזרה (sub-sub)
```

## 🛠️ איך ליצור סעיפים ב-Supabase Dashboard

### שלב 1: כניסה ל-Supabase Dashboard
1. היכנסי ל-[Supabase Dashboard](https://supabase.com/dashboard)
2. בחרי את הפרויקט שלך
3. לכי ל-**Table Editor**
4. בחרי את הטבלה **`hierarchical_sections`**

### שלב 2: יצירת סעיף ראשי
1. לחצי על **"Insert"** → **"Insert row"**
2. מלאי את השדות:
   - **`id`**: השאר ריק (ייווצר אוטומטית)
   - **`title`**: כותרת הסעיף (לדוגמה: "שכר טרחה בסיסי")
   - **`content`**: תוכן הסעיף
   - **`level`**: `main` (חשוב מאוד!)
   - **`parent_id`**: השאר ריק או `null`
   - **`order_index`**: מספר סדר (1, 2, 3...)
   - **`category`**: קטגוריה (לדוגמה: "fee_agreement")
   - **`user_id`**: השאר ריק (לסעיפים ציבוריים)
   - **`created_at`**: השאר ריק (ייווצר אוטומטית)

### שלב 3: יצירת תת-סעיף
1. צרי שורה חדשה
2. מלאי את השדות:
   - **`title`**: כותרת התת-סעיף
   - **`content`**: תוכן התת-סעיף
   - **`level`**: `sub` (חשוב מאוד!)
   - **`parent_id`**: העתיקי את ה-ID של הסעיף הראשי
   - **`order_index`**: מספר סדר בתוך הסעיף הראשי
   - **`category`**: אותה קטגוריה כמו הסעיף הראשי

### שלב 4: יצירת תת-תת-סעיף
1. צרי שורה חדשה
2. מלאי את השדות:
   - **`title`**: כותרת התת-תת-סעיף
   - **`content`**: תוכן התת-תת-סעיף
   - **`level`**: `sub-sub` (חשוב מאוד!)
   - **`parent_id`**: העתיקי את ה-ID של התת-סעיף
   - **`order_index`**: מספר סדר בתוך התת-סעיף
   - **`category`**: אותה קטגוריה

## 📝 דוגמה מעשית

### יצירת "שכר טרחה בסיסי":

**שורה 1 - סעיף ראשי:**
```
id: (אוטומטי)
title: "שכר טרחה בסיסי"
content: "שכר הטרחה הבסיסי כולל..."
level: "main"
parent_id: (ריק)
order_index: 1
category: "fee_agreement"
```

**שורה 2 - תת-סעיף:**
```
id: (אוטומטי)
title: "מפגש ראשון"
content: "במפגש הראשון..."
level: "sub"
parent_id: [ID של השורה 1]
order_index: 1
category: "fee_agreement"
```

**שורה 3 - תת-תת-סעיף:**
```
id: (אוטומטי)
title: "הכנת הצוואה"
content: "עורך הדין יכין..."
level: "sub-sub"
parent_id: [ID של השורה 2]
order_index: 1
category: "fee_agreement"
```

## ⚠️ כללים חשובים

### 1. שדה `level` - קריטי!
- **חובה** להיות בדיוק: `main`, `sub`, או `sub-sub`
- לא לכתוב תוכן אחר בשדה הזה!

### 2. שדה `parent_id`
- לסעיף ראשי: ריק או `null`
- לתת-סעיף: ID של הסעיף הראשי
- לתת-תת-סעיף: ID של התת-סעיף

### 3. שדה `order_index`
- קובע את סדר התצוגה
- התחל מ-1 בכל רמה

### 4. שדה `category`
- השתמשי בקטגוריות קבועות:
  - `fee_agreement` - הסכמי שכר טרחה
  - `will_individual` - צוואת יחיד
  - `will_mutual` - צוואה הדדית
  - `advance_directives` - הוראות מקדימות

## 🔍 איך לבדוק שהכל עובד

### בדיקה מהירה:
1. לכי לאפליקציה
2. פתחי מסמך שכר טרחה
3. לחצי על "טען סעיפים היררכיים"
4. אמורה להופיע רשימה של הסעיפים שיצרת

### אם משהו לא עובד:
1. בדקי שהשדה `level` נכון
2. בדקי שה-`parent_id` מצביע על ID קיים
3. בדקי שה-`category` תואמת למסמך

## 📞 תמיכה

אם יש בעיות:
1. בדקי את הקונסול בדפדפן (F12)
2. השתמשי בסקריפט הבדיקה: `node scripts/check-hierarchical-sections.js`
3. פני לעזרה טכנית

---

**זכרי:** המערכת תומכת רק ב-3 רמות: main → sub → sub-sub
